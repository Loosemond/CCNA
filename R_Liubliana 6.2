en
conf t
hostname R_Liubliana
username cisco secret class
username cisco privilege 15
ip domain-name CCNA-lab.com
line vty 0 4
transport input ssh
login local
exit
crypto key generate rsa modulus 1024
line con 0
login local
exit
ipv6 unicast-routing
service password-encryption

banner motd !Acesso Restrito a Utilizadores Autorizados!
banner login !Efetue um backup de segurança antes de efetuar alterações!

!---BGP
router bgp 60003
neighbor 63.49.54.22 remote-as 60000
no synchronization
exit

!---Syslog
conf t
logging on
service timestamp log uptime
service sequence-numbers

no ip route 0.0.0.0 0.0.0.0 63.49.54.22

!----Eigrp
key chain AS100
key 1
key-string netacad
exit
exit
router eigrp 55
passive-interface default
no passive-interface multilink 1
no passive-interface s0/0/0
no passive-interface s0/0/1
no auto-summary
network 56.16.20.212 0.0.0.3
redistribute OSPF 1 metric 1000 100 250 100 1500
redistribute static
exit


!---Interfaceses
interface gi 0/1
description connect to SPN
ip address 63.49.54.21 255.255.255.252
ipv6 address fe80::3 link-local
no shut
exit

interface multilink 1
ip address 56.16.20.213 255.255.255.252
ipv6 address fe80::3 link-local
bandwidth 20000
ip authentication mode eigrp 55 md5
ip authentication key-chain eigrp 55 AS100
exit

username R_Bratislava password 0 cisco

interface serial 0/0/0
description connect Bratislava l1
clock rate 2000000
encapsulation ppp
ppp quality 80
compress predictor
ppp authentication chap
ppp multilink group 1
no shut
exit

interface serial 0/0/1
description connect Bratislava l2
clock rate 2000000
encapsulation ppp
ppp quality 80
compress predictor
ppp authentication chap
ppp multilink group 1
no shut
exit
end


!-----Loopback
conf t
interface Loopback 0
description LoopBack Liubliana Traffic Controllers
ip address 172.19.20.1 255.255.254.0
ip ospf 1 area 3
ipv6 address 1000:0:0:30::1/64
ipv6 ospf 3 area 3
exit

interface Loopback 1
description Loopback Liubliana IP CAMs
ip address 172.19.26.1 255.255.254.0
ip ospf 1 area 3
ipv6 address 1000:0:0:31::1/64
ipv6 ospf 3 area 3
exit

interface Loopback 2
description Loopback Liubliana Administrative Personal
ip address 172.19.22.1 255.255.254.0
ip ospf 1 area 3
ipv6 address 1000:0:0:32::1/64
ipv6 ospf 1 area 3
exit

interface Loopback 3
description Loopback Liubliana VoIP
ip address 172.19.16.1 255.255.252.0
ip ospf 1 area 3
ipv6 address 1000:0:0:33::1/64
ipv6 ospf 3 area 3
exit

interface Loopback 4
description Loopback Liubliana Engineering
ip address 172.19.24.1 255.255.254.0
ip ospf 1 area 3
ipv6 address 1000:0:0:34::1/64
ipv6 ospf 1 area 3
exit

interface Loopback5
description Loopback Liubliana Building Management
ip address 172.19.28.1 255.255.254.0
ip ospf 1 area 3
ipv6 address 1000:0:0:35::1/64
ipv6 ospf 3 area 3
exit

!---VPN
!--- PSK -> Pre shared key
!--acl

ip access-list extended set3-acl
permit gre host 63.49.54.21 host 209.165.200.97
permit gre host 63.49.54.21 host 193.136.60.106
deny ip any any


crypto isakmp policy 10
encryption 3des
authentication pre-share
group 5 !--hellman
hash sha
Exit


!--set da pass
crypto isakmp key ViLiu12345 address 193.136.60.106
crypto isakmp key BudaLiu12345 address 209.165.200.97

!-cria o set para cada tunel
crypto ipsec transform-set tset1 esp-3des esp-sha-hmac
crypto map map1 10 ipsec-isakmp
set peer 193.136.60.106
set transform-set tset1
match address set3-acl

crypto ipsec transform-set tset2 esp-3des esp-sha-hmac
crypto map map1 10 ipsec-isakmp
set peer 209.165.200.97
set transform-set tset2
match address set3-acl

interface gigabitethernet0/1
description connect to SPN
crypto map map1
exit

interface Tunnel1
description VPN to Budapeste
ip address 10.0.0.9 255.255.255.252
ip ospf 1 area 0
ip ospf message-digest-key 1 md5 netacad
ip ospf hello-interval 20
ip ospf dead-interval 80
ip ospf cost 120
ipv6 address fe80::3 link-local
ipv6 ospf 3 area 0
ipv6 ospf hello-interval 20
ipv6 ospf dead-interval 40
tunnel source 63.49.54.21
tunnel destination 209.165.200.97
bandwidth 100000
exit

interface Tunnel2
description VPN to Vienna
ip address 10.0.0.6 255.255.255.252
ip ospf 1 area 0
ip ospf message-digest-key 1 md5 netacad
ip ospf hello-interval 20
ip ospf dead-interval 80
ipv6 address fe80::3 link-local
ipv6 ospf 3 area 0
ipv6 ospf hello-interval 20
ipv6 ospf dead-interval 40
tunnel source 63.49.54.21
tunnel destination 193.136.60.106
bandwidth 100000
exit


!----OSPFv2
router ospf 1
passive-interface default
no passive-interface Tunnel1
no passive-interface Tunnel2
router-id 1.1.1.3
network 172.19.128.0 0.0.15.255 area 3
area 3 range 172.19.128.0 255.255.240.0
area 0 authentication message-digest
redistribute EIGRP 55 subnets
default-information originate
exit

!----OSPFv3
ipv6 router ospf 3
router-id 1.1.1.3
passive-interface default
no passive-interface Tunnel1
no passive-interface Tunnel2
area 3 range 1000:0:0:30::0/60
exit


!-------HOST TABLE
ip host R_Vienna 193.136.60.106
ip host R_Budapest 209.165.200.97
ip host R_Liubliana 63.49.54.21
ip host R_Bratislava 56.16.20.214
ip host Sw1_Vienna 172.19.12.1
ip host Sw2_Vienna 172.19.12.2
ip host MLS1_Vienna 172.19.12.253
ip host MLS2_Vienna 172.19.12.252
ip host SPN 63.49.54.22 193.136.60.107 209.165.200.98

!---ACLs
ip access-list standard ipcams
permit 172.19.22.0 0.0.1.255
permit 172.19.6.0 0.0.1.255
deny any
exit
interface loopback1
ip access-group  ipcams in



!---Clock

ntp server 193.136.60.106 prefer
exit

copy running-config startup-config
